!function(){"use strict";function t(t,o){const n=r(t),l=[];for(const r of n){const n=e(f(t,r,2),o-1,-1/0,1/0,!1);l.push([r,n])}return l.sort((t,e)=>t[1]===e[1]?0:t[1]>e[1]?-1:1)[0][0]}function e(t,o,n,l,s){let a=n,i=l;const u=function(t){let e=[];for(let r=0;r<6;r++){let f=0,o=0;for(let n=0;n<7;n++)if(t[r][n]!==o?(f=1,e=[r,n],o=t[r][n]):0!=o&&f++,f>=4)return{team:o,first:e,last:[r,n]}}for(let r=0;r<7;r++){let f=0,o=0;for(let n=0;n<6;n++)if(t[n][r]!==o?(f=1,e=[n,r],o=t[n][r]):0!=o&&f++,f>=4)return{team:o,first:e,last:[n,r]}}for(let r=0;r<6;r++){let f=0,o=0;for(let n=0;n<=r&&n<=7;n++)if(t[r-n][n]!==o?(f=1,e=[r-n,n],o=t[r-n][n]):0!=o&&f++,f>=4)return{team:o,first:e,last:[r-n,n]};f=0,o=0;for(let n=0;n<=5-r&&n<=7;n++)if(t[r+n][6-n]!==o?(f=1,e=[r+n,6-n],o=t[r+n][6-n]):0!=o&&f++,f>=4)return{team:o,first:e,last:[r+n,6-n]}}for(let r=0;r<6;r++){let f=0,o=0;for(let n=0;n<=r&&n<=7;n++)if(t[r-n][6-n]!==o?(f=1,e=[r-n,6-n],o=t[r-n][6-n]):0!=o&&f++,f>=4)return{team:o,first:e,last:[r-n,6-n]};f=0,o=0;for(let n=0;n<=5-r&&n<=7;n++)if(t[r+n][n]!==o?(f=1,e=[r+n,n],o=t[r+n][n]):0!=o&&f++,f>=4)return{team:o,first:e,last:[r+n,n]}}return{team:0,first:[],last:[]}}(t);if(0!==u.team)return 2===u.team?1e13:-1e13;if(!function(t){for(let e=0;e<t.length;e++)for(let r=0;r<t[e].length;r++)if(0===t[e][r])return!0;return!1}(t))return 0;if(0===o)return function(t){const e={1:0,2:0};for(let r=0;r<6;r++){let f=0,o=0;for(let n=0;n<7;n++)t[r][n]!==o?(e[o]+=f*f,f=1,o=t[r][n]):0!=o&&f++}for(let r=0;r<7;r++){let f=0,o=0;for(let n=0;n<6;n++)t[n][r]!==o?(e[o]+=f*f,f=1,o=t[n][r]):0!=o&&f++}for(let r=0;r<6;r++){let f=0,o=0;for(let n=0;n<=r&&n<=7;n++)t[r-n][n]!==o?(e[o]+=f*f,f=1,o=t[r-n][n]):0!=o&&f++;f=0,o=0;for(let n=0;n<=5-r&&n<=7;n++)t[r+n][6-n]!==o?(e[o]+=f*f,f=1,o=t[r+n][6-n]):0!=o&&f++}for(let r=0;r<6;r++){let f=0,o=0;for(let n=0;n<=r&&n<=7;n++)t[r-n][6-n]!==o?(e[o]+=f*f,f=1,o=t[r-n][6-n]):0!=o&&f++;f=0,o=0;for(let n=0;n<=5-r&&n<=7;n++)t[r+n][n]!==o?(e[o]+=f*f,f=1,o=t[r+n][n]):0!=o&&f++}return e}(t)[2];const c=r(t);if(s){let r=-1e13;for(const n of c){const l=e(f(t,n,2),o-1,a,i,!1);if(r=l>r?l:r,a=r>a?r:a,a>=i)break}return r}{let r=1e13;for(const n of c){const l=e(f(t,n,1),o-1,a,i,!0);if(r=l<r?l:r,i=r<i?r:i,a>=i)break}return r}}function r(t){const e=[];for(let r=0;r<t[0].length;r++)t[0][r]||e.push(r);return e}function f(t,e,r){const f=function(t){const e=[];for(const r of t)e.push(r.slice());return e}(t);for(let o=t.length-1;o>=0;o--)if(!f[o][e])return f[o][e]=r,f}let o=4;onmessage=e=>{if(!(e.data.length<2))switch(e.data[0]){case"move":postMessage(["move",t(e.data[1],o)]);break;case"setLevel":if("number"!=typeof e.data[1]||e.data[1]<4||e.data[1]>8){postMessage(["error","AI level should be in the range of 3 to 7"]);break}o=e.data[1]}}}();
